<!DOCTYPE html>
<html>
  <head>
    <title>jsmodules - example 5</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.min.js"></script>
    <script src="jsmodules.js" type="text/javascript"></script>
    <script src="jsmodules.history.js" type="text/javascript"></script>
    <style>
      body { background-color: #ddd; color: #222; font-family: Arial; padding: 0; margin: 0; }
      #content { padding: 20px; }
      h1 { color: #ccff77; background-color: #222222; padding: 20px; margin: 0; }
      h2, h3 { color: #308; }
      a { color: #004; }
      #demo {overflow: hidden; }
      #demo a {display: block; }
      #demo>div {margin-top: 15px; padding: 15px; background-color: #fff; width: 150px;position: relative;}
      #demo .square {position: absolute; top: 16px; left: 100px; width: 50px; height: 50px }
      #demo>div { width: 136px; height: 52px; float: left; margin-left: 10px; }
    </style>
  </head>
  <body data-jsModules="history">
    <h1>JSMODULES example 5: the history module</h1>
    <div id="content">
      <p>The first ready to use module. It uses HTML5 history and jQuery.load to allow the user to load parts of the web page and make it work together with the browser's history. This could typically be a simple js file. So what are the benefits to put it as a jsModules?</p>
      <ul>
        <li>You don't add any variable to the global namespace</li>
        <li>You have the same stucture for every piece of javascript on your website</li>
        <li>It uses JSMODULES pubsub, better than a simple callback</li>
      </ul>
      <h2>History module's API</h2>
      <p>You need to load the file jsmodules.history.js and its dependencies: jsmodules.css and part-loader.png. Then you add data-jsModule="history", preferably to the body. This way, looking at the DOM, already gives you an indication about what the js is using. This module has a couple of public functions which you can call directly (you need to prefix them with JSMODULES.modules.history):</p>
      <ul>
        <li><strong>load(url, mainEl)</strong>: load mainEl of the page located at the url into mainEl of the current page and registers this into the browser history. This is the main function of this module. It works a little bit like jQuery.load (and uses it), but adds the HTML5 history to it. Also, the mainEl is the same in the current page than in the remote page. Which makes the function a little less versatile, but very straightforward to use.</li>
        <li><strong>reload(mainEl)</strong>: Reload the mainEl of the current page</li>
      </ul>
      <h2>History module basic usage and example</h2>
      <p>You might not even need to call this functions, if you want a link to only update a part of the page, just put the attribute <code>data-remote="<em>selector</em>"</code>, where <em>selector</em> can be any jQuery selector, like "#content" for instance.</p>
      <p>Here is an example where you can switch the color of the squares and go back with the browser's back button</p>
      <div id="demo">
        <div class="square-1">
          <a href="?square1=00f" data-remote=".square-1">blue</a>
          <a href="?square1=f00" data-remote=".square-1">red</a>
          <a href="?square1=0f0" data-remote=".square-1">green</a>
          <div class="square" <% if params[:square1] %>style="background-color:#<%= params[:square1] %>"<% end %>></div>
        </div>
        <div class="square-2">
          <a href="?square2=00f" data-remote=".square-2">blue</a>
          <a href="?square2=f00" data-remote=".square-2">red</a>
          <a href="?square2=0f0" data-remote=".square-2">green</a>
          <div class="square" <% if params[:square2] %>style="background-color:#<%= params[:square2] %>"<% end %>></div>
        </div>
        <div class="square-3">
          <a href="?square3=00f" data-remote=".square-3">blue</a>
          <a href="?square3=f00" data-remote=".square-3">red</a>
          <a href="?square3=0f0" data-remote=".square-3">green</a>
          <div class="square" <% if params[:square3] %>style="background-color:#<%= params[:square3] %>"<% end %>></div>
        </div>
      </div>
      <br/>
      <a href="/example4">&lt;&lt; previous</a>
    </div>
  </body>
</html>